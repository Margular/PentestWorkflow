#!/usr/bin/env python3
# -*- coding:utf-8 -*-

import os
import re

directory = r'E:\迅雷下载\爱拍2亿数据库'  #文件夹目录
outpath = r'E:\迅雷下载\aipai.txt'              #整理后文件路径
errorpath = r'E:\迅雷下载\aipai_error.txt'      #不符合要求的行输出路径
search = r'(.*)([0-9a-fA-F]{32})(.*)'

outfile = open(outpath, 'w')
errorfile = open(errorpath, 'w')

for filename in os.listdir(directory):  #遍历文件
    filepath = os.path.join(directory, filename)    #文件路径
    print('处理文件: ' + filepath)
    with open(filepath, errors = 'backslashreplace') as file:
        for line in file:
            line = line.strip()
            if line == '' or line.find('"') != -1:      #去掉空行和包含"的行
                continue
            result = re.search(search, line)
            if result:       #满足要求的行
                (username, password, email) = result.groups()
                username = username.strip()
                email = email.strip()
                outfile.write(username + '"' + password + '"' + email + '\n')
            else:   #不满足要求的行
                errorfile.write(line + '\n')

errorfile.close()
outfile.close()
