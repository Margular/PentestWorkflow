#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import sys


def main():
    if len(sys.argv) < 2:
        print('please input the http.msf file')
        sys.exit(1)
    else:
        msf = sys.argv[1]
    services = open(msf).read().strip().split('\n')
    for service in services:
        if not service.startswith('"'):
            continue
        _ = service.split('"')
        protocol, host, port = _[7], _[1], _[3]
        if 'https' in protocol or 'ssl' in protocol:
            protocol = 'https'
        else:
            protocol = 'http'
        url = '{}://{}:{}'.format(protocol, host, port)
        with open('urls.txt', 'a') as f:
            f.write(url)
            f.write('\n')


if __name__ == '__main__':
    main()
